define("parsley/field",["parsley/factory/constraint","parsley/ui","parsley/utils"],function(b,d,c){var a=function(f,g,e){this.__class__="ParsleyField";this.__id__=c.hash(4);this.$element=$(f);if("undefined"!==typeof e){this.parent=e;this.OptionsFactory=this.parent.OptionsFactory;this.options=this.OptionsFactory.get(this)}else{this.OptionsFactory=g;this.options=this.OptionsFactory.get(this)}this.constraints=[];this.constraintsByName={};this.validationResult=[];this._bindConstraints()};a.prototype={validate:function(e){this.value=this.getValue();$.emit("parsley:field:validate",this);$.emit("parsley:field:"+(this.isValid(e,this.value)?"success":"error"),this);$.emit("parsley:field:validated",this);return this.validationResult},isValid:function(h,g){this.refreshConstraints();var e=this._getConstraintsSortedPriorities();g=g||this.getValue();if(0===g.length&&!this._isRequired()&&"undefined"===typeof this.options.validateIfEmpty&&true!==h){return this.validationResult=[]}if(false===this.options.priorityEnabled){return true===(this.validationResult=this.validateThroughValidator(g,this.constraints,"Any"))}for(var f=0;f<e.length;f++){if(true!==(this.validationResult=this.validateThroughValidator(g,this.constraints,e[f]))){return false}}return true},getValue:function(){var e;if("undefined"!==typeof this.options.value){e=this.options.value}else{e=this.$element.val()}if("undefined"===typeof e||null===e){return""}if(true===this.options.trimValue){return e.replace(/^\s+|\s+$/g,"")}return e},refreshConstraints:function(){return this.actualizeOptions()._bindConstraints()},addConstraint:function(f,h,g,e){f=f.toLowerCase();if("function"===typeof window.ParsleyValidator.validators[f]){var i=new b(this,f,h,g,e);if("undefined"!==this.constraintsByName[i.name]){this.removeConstraint(i.name)}this.constraints.push(i);this.constraintsByName[i.name]=i}return this},removeConstraint:function(e){for(var f=0;f<this.constraints.length;f++){if(e===this.constraints[f].name){this.constraints.splice(f,1);break}}return this},updateConstraint:function(e,g,f){return this.removeConstraint(e).addConstraint(e,g,f)},_bindConstraints:function(){var g=[];for(var f=0;f<this.constraints.length;f++){if(false===this.constraints[f].isDomConstraint){g.push(this.constraints[f])}}this.constraints=g;for(var e in this.options){this.addConstraint(e,this.options[e])}return this._bindHtml5Constraints()},_bindHtml5Constraints:function(){if(this.$element.hasClass("required")||this.$element.attr("required")){this.addConstraint("required",true,undefined,true)}if("string"===typeof this.$element.attr("pattern")){this.addConstraint("pattern",this.$element.attr("pattern"),undefined,true)}if("undefined"!==typeof this.$element.attr("min")&&"undefined"!==typeof this.$element.attr("max")){this.addConstraint("range",[this.$element.attr("min"),this.$element.attr("max")],undefined,true)}else{if("undefined"!==typeof this.$element.attr("min")){this.addConstraint("min",this.$element.attr("min"),undefined,true)}else{if("undefined"!==typeof this.$element.attr("max")){this.addConstraint("max",this.$element.attr("max"),undefined,true)}}}var e=this.$element.attr("type");if("undefined"===typeof e){return this}if("number"===e){return this.addConstraint("type","integer",undefined,true)}else{if(new RegExp(e,"i").test("email url range")){return this.addConstraint("type",e,undefined,true)}}return this},_isRequired:function(){if("undefined"===typeof this.constraintsByName.required){return false}return false!==this.constraintsByName.required.requirements},_getConstraintsSortedPriorities:function(){var e=[];for(var f=0;f<this.constraints.length;f++){if(-1===e.indexOf(this.constraints[f].priority)){e.push(this.constraints[f].priority)}}e.sort(function(h,g){return g-h});return e}};return a});