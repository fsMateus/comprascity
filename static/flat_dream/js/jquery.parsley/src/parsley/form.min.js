define("parsley/form",["parsley/abstract","parsley/utils"],function(a,c){var b=function(d,e){this.__class__="ParsleyForm";this.__id__=c.hash(4);if("OptionsFactory"!==c.get(e,"__class__")){throw new Error("You must give an OptionsFactory instance")}this.OptionsFactory=e;this.$element=$(d);this.validationResult=null;this.options=this.OptionsFactory.get(this)};b.prototype={onSubmitValidate:function(d){this.validate(undefined,undefined,d);if(false===this.validationResult&&d instanceof $.Event){d.stopImmediatePropagation();d.preventDefault()}return this},validate:function(h,g,f){this.submitEvent=f;this.validationResult=true;var d=[];this._refreshFields();$.emit("parsley:form:validate",this);for(var e=0;e<this.fields.length;e++){if(h&&h!==this.fields[e].options.group){continue}d=this.fields[e].validate(g);if(true!==d&&d.length>0&&this.validationResult){this.validationResult=false}}$.emit("parsley:form:validated",this);return this.validationResult},isValid:function(f,e){this._refreshFields();for(var d=0;d<this.fields.length;d++){if(f&&f!==this.fields[d].options.group){continue}if(false===this.fields[d].isValid(e)){return false}}return true},_refreshFields:function(){return this.actualizeOptions()._bindFields()},_bindFields:function(){var d=this;this.fields=[];this.fieldsMappedById={};this.$element.find(this.options.inputs).each(function(){var e=new window.Parsley(this,{},d);if(("ParsleyField"===e.__class__||"ParsleyFieldMultiple"===e.__class__)&&!e.$element.is(e.options.excluded)){if("undefined"===typeof d.fieldsMappedById[e.__class__+"-"+e.__id__]){d.fieldsMappedById[e.__class__+"-"+e.__id__]=e;d.fields.push(e)}}});return this}};return b});